function ___iZZZZ(___n,gid,__SZZ,history,____TZ,____UZ){this.___bZZZZ=___n;this.___eZZZZ=gid;___jZZZZ=this;this.___kZZZZ=false;this.___lZZZZ=0;this.___mZZZZ=0.5*u;__TZZ.iZZ(this,__SZZ,history,____TZ,____UZ);this._____UZ=[null,null];this.__WZZ._uZZZ.DZZ();this.__WZZ.___vZZZ.DZZ();this.___nZZZZ();this.___oZZZZ=false;this._HZZZ._TZZZ._zZZ(this,function(){this.___pZZZZ();this.___qZZZZ();});this._HZZZ._JZZZ._zZZ(this,function(data){var _UZZZ=data._vZZZ;this.___rZZZZ(_UZZZ);this.___sZZZZ(_UZZZ);if(!this._HZZZ.___IZZ){this.__YZZ._oZZZ(_UZZZ._WZZZ);if(_UZZZ.___VZ===_$ZZZ._RZZZ(this.___aZZ)&&_.a.___GZ.___QZ.__HZZ.__wZ()){var self=this;var _$ZZ=new __YZZ(this._XZZZ._pZZZ());var fs=_UZZZ.__fZZZ;var ts=_UZZZ.__gZZZ;if(_UZZZ._YZZZZ!==null){_$ZZ._oZZZ(_UZZZ._YZZZZ._WZZZ);}
var piece=_$ZZ.__WZZ[fs];this.__WZZ.DZZZZ(fs,zZZZZ);this.__WZZ.DZZZZ(ts,zZZZZ);this.__WZZ._____eZZ.BZZ(false);this.__WZZ.____gZZZ(piece,fs,ts,function(){self.__WZZ._____eZZ.BZZ(true);self.___qZZZZ();});}
else{this.___qZZZZ();}
this._JZZZ.t();}});this.___tZZZZ=null;this.___uZZZZ=null;this.___vZZZZ=null;this.__UZZ=false;this.__VZZ();this.highlight_last_move=_.a.___GZ.___QZ.__GZZ.__wZ();_.a.___GZ.___QZ.__BZZ._zZZ(this,function(data,sender){this.__GZZ.BZZ(sender.__GZZ.__wZ());});this.___wZZZZ=true;this.___xZZZZ=0;this.___yZZZZ=new ___yZZZZ(this);this.___yZZZZ.___m._zZZ(this,function(){this.___qZZZZ();});this.___yZZZZ.___zZZZZ._zZZ(this,function(){this.___AZZZZ();});this.___BZZZZ();this.___CZZZZ();_.a.___HZ._zZZ(this,function(){this.___DZZZZ();});this.___EZZZZ=-1;this.___FZZZZ=-1;this.___GZZZZ=false;this.cZZZ();this.__fZZ();}
___iZZZZ.___HZZZZ={};___iZZZZ.___HZZZZ[YZ]=0;___iZZZZ.___HZZZZ[XZ]=1;___iZZZZ.___IZZZZ=100;___iZZZZ.prototype.___BZZZZ=function(){this.___JZZZZ();this.___AZZZZ();this._DZZ(this.__WZZ);this.__WZZ.__XZZ._zZZ(this,function(data){if((this._HZZZ.___WZZ.hZZZZZ!==null&&this._HZZZ._VZZZ!=this._HZZZ.___WZZ.hZZZZZ)||this.___eZZ!==VZ||this.____ZZ===__TZZ.___KZZ||(this.____ZZ===__TZZ.___JZZ&&this.___aZZ!==_$ZZZ.colour(data._aZZZ))){data._bZZZ=true;}});this.__WZZ._cZZZ._zZZ(this,function(data){if(this.__WZZ._dZZZ._eZZZ===_fZZZ._gZZZ){this.__WZZ._hZZZ(data._iZZZ);}});this.__WZZ._jZZZ._zZZ(this,function(){this.__WZZ._kZZZ();});this.__WZZ._lZZZ._zZZ(this,function(data){if(this.__YZZ.__ZZZ===this.___aZZ){this._lZZZ(data._mZZZ,data._nZZZ);}
else{if(_.a.___GZ.___QZ.__NZZ.__wZ()){this.___KZZZZ(data._mZZZ,data._nZZZ);}}});this.__WZZ.LZZZZ(this.__YZZ.__WZZ);this.___qZZZZ();}
___iZZZZ.prototype.LZZZZ=function(__SZZ){this._DZZ(this.__WZZ);this.__WZZ=__SZZ;this.___BZZZZ();}
___iZZZZ.prototype.___rZZZZ=function(_UZZZ){if(_UZZZ.__uZZZ!==null){if(_UZZZ.rZZZZZ>this.___EZZZZ){var colour=_$ZZZ.colour(_UZZZ.__uZZZ);if(this.___HZZ[colour]!==null){this.___HZZ[colour]._P(_UZZZ.__uZZZ);this.___EZZZZ=_UZZZ.rZZZZZ;}}}}
___iZZZZ.prototype.___sZZZZ=function(_UZZZ){if(_UZZZ.tZZ.__rZZZ===_____OZ){if(_UZZZ.rZZZZZ>this.___FZZZZ){var colour=_$ZZZ.colour(_UZZZ._aZZZ);if(this._____UZ[colour]!==null){this._____UZ[colour]._S(_UZZZ._aZZZ);this.___FZZZZ=_UZZZ.rZZZZZ;}}}}
___iZZZZ.prototype.___LZZZZ=function(____TZ,colour){this.___HZZ[colour]=____TZ;this.___CZZZZ();}
___iZZZZ.prototype.___CZZZZ=function(){this._HZZZ.___WZZ.___XZZ._U(function(_UZZZ){this.___rZZZZ(_UZZZ);this.___sZZZZ(_UZZZ);},this);}
___iZZZZ.prototype.___MZZZZ=function(){___aZZZZ.iZZ(this._HZZZ,this.___bZZZZ,this);this._HZZZ.___m._zZZ(this,function(){this.___pZZZZ();if(!this.___GZZZZ){this.___NZZZZ();this.___GZZZZ=true;}});}
___iZZZZ.prototype.___OZZZZ=function(___PZZZZ,colour){if(this._cZ===XZ){if(this._____UZ[colour]!==null){this._DZZ(this._____UZ[colour]);}
this._____UZ[colour]=___PZZZZ;if(this._____UZ[colour]!==null){this.___QZZZZ(colour);}}}
___iZZZZ.prototype.___QZZZZ=function(colour){if(this._cZ===XZ){this._____UZ[colour]._____YZ._zZZ(this,function(data,sender){if(this.__WZZ.____wZZ(data.h)){this.___RZZZZ(data._aZZZ,this.__WZZ._____NZZ(data.h));}});this._____UZ[colour].__XZZ._zZZ(this,function(data){if((this._HZZZ.___WZZ.hZZZZZ!==null&&this._HZZZ._VZZZ!=this._HZZZ.___WZZ.hZZZZZ)||this.___eZZ!==VZ||this.____ZZ===__TZZ.___KZZ||(this.____ZZ===__TZZ.___JZZ&&this.___aZZ!==_$ZZZ.colour(data._aZZZ))||this.__YZZ.__ZZZ!==this.___aZZ){data._bZZZ=true;}});this._HZZZ.___WZZ.___XZZ._U(function(_UZZZ){this.___rZZZZ(_UZZZ);this.___sZZZZ(_UZZZ);},this);}}
___iZZZZ.prototype.__VZZ=function(){this._EZZZ=new h(this);this.___m=new h(this);this._rZZZ=new h(this);}
___iZZZZ.prototype.cZZZ=function(){__TZZ.prototype.cZZZ.call(this);this.__GZZ=new lZZ(this,function(){return this.highlight_last_move;},function(value){this.highlight_last_move=value;this.___pZZZZ();});this.___LZZ=new lZZ(this,function(){return this.___aZZ;},function(value){this.___aZZ=value;this.___qZZZZ();});}
___iZZZZ.prototype.___KZZZZ=function(fs,ts,promote_to){var _sZZZ=false;var piece=this.__WZZ.EZZZZ(fs);if(_$ZZZ.type(piece)===_tZZZ&&(_$ZZZ.__QZ(ts)===0||_$ZZZ.__QZ(ts)===7)&&!promote_to){_sZZZ=true;if(_.a.___GZ.___QZ.__OZZ.__wZ()){promote_to=vZZZZ;}
else{this.__WZZ._uZZZ.EZZ();this.__WZZ._uZZZ.___VZ.BZZ(this.___aZZ);this.__WZZ._uZZZ._cZZZ._zZZ(this,function(data){this.___KZZZZ(fs,ts,data._aZZZ);this.__WZZ._uZZZ.DZZ();return true;});}}
if(promote_to||!_sZZZ){var _UZZZ=this.___SZZZZ(fs,ts,promote_to);if(_UZZZ.OZZZZ){this.___yZZZZ._P(_UZZZ);}}}
___iZZZZ.prototype.___DZZZZ=function(){this.___yZZZZ._zZZZZ();if(this.___yZZZZ._M.length===0){this.___pZZZZ();}}
___iZZZZ.prototype.___qZZZZ=function(){var _UZZZ;this.__WZZ.LZZZZ(this.__YZZ.__WZZ);this.___AZZZZ();if(this._HZZZ.___WZZ.___XZZ._N>0){while(this.___yZZZZ._M.length>0&&this.___yZZZZ._M[0].rZZZZZ<=this._HZZZ.___WZZ.hZZZZZ.rZZZZZ){this.___yZZZZ._M.shift();}}
if(this.___eZZ===VZ){for(var O=0;O<this.___yZZZZ._M.length;O++){_UZZZ=this.___yZZZZ._M[O];if(!this.___TZZZZ(_UZZZ.__fZZZ,_UZZZ.__gZZZ,_UZZZ.__GZZZ,_UZZZ.rZZZZZ)){break;}}}}
___iZZZZ.prototype.___AZZZZ=function(){var _UZZZ;for(var O=0;O<this.___yZZZZ._M.length;O++){_UZZZ=this.___yZZZZ._M[O];this.__WZZ._____VZZ(_UZZZ.__fZZZ);this.__WZZ._____VZZ(_UZZZ.__gZZZ);}}
___iZZZZ.prototype.___TZZZZ=function(fs,ts,promote_to,move_index){var eZZZZZ=false;var _UZZZ=this.___SZZZZ(fs,ts,promote_to,move_index);if(_UZZZ.OZZZZ){for(var O=0;O<_UZZZ.__wZZZ.length;O++){this.__WZZ.DZZZZ(_UZZZ.__wZZZ[O]._iZZZ,_UZZZ.__wZZZ[O].__xZZZ);}
this.__WZZ._____UZZ(_UZZZ.__fZZZ,this.__WZZ._____$ZZ);this.__WZZ._____UZZ(_UZZZ.__gZZZ,this.__WZZ._____aZZ);eZZZZZ=true;}
return eZZZZZ;}
___iZZZZ.prototype.___SZZZZ=function(fs,ts,promote_to,move_index){promote_to=promote_to||null;move_index=_sZ(move_index)?move_index:null;var piece=new _aZZZ(this.__WZZ.EZZZZ(fs));var __eZZZ=new _aZZZ(this.__WZZ.EZZZZ(ts));var colour=this.___aZZ;var _UZZZ=new _vZZZ();if(move_index===null){move_index=[0,1][colour];if(this.___yZZZZ._M.length>0){move_index=___rZ(this.___yZZZZ._M).rZZZZZ+2;}
else if(this._HZZZ.___WZZ.___XZZ._N>0){move_index=this._HZZZ.___WZZ.hZZZZZ.rZZZZZ+2;}}
_UZZZ.__fZZZ=fs;_UZZZ.__gZZZ=ts;_UZZZ.rZZZZZ=move_index;if(_$ZZZ.__hZZZ(fs)&&_$ZZZ.__hZZZ(ts)&&piece._cZ!==zZZZZ){var __iZZZ=_$ZZZ.__jZZZ(fs);var __kZZZ=_$ZZZ.__jZZZ(ts);var __lZZZ=_$ZZZ.__mZZZ(fs,colour);var __nZZZ=_$ZZZ.__mZZZ(ts,colour);var _RZZZ=_$ZZZ._RZZZ(colour);var ___UZZZZ=false;var ___VZZZZ=(__eZZZ._cZ!==zZZZZ&&__eZZZ.___VZ===colour);var __VZZZ=_$ZZZ.__VZZZ(fs,ts);var FZZZZ;for(var O=0;O<__VZZZ.length;O++){FZZZZ=this.__WZZ.__WZZ[__VZZZ[O]];if(FZZZZ!==zZZZZ&&_$ZZZ.colour(FZZZZ)===colour){___UZZZZ=true;break;}}
var ___WZZZZ=(___UZZZZ||___VZZZZ);if(_$ZZZ.__vZZZ(piece._cZ,__iZZZ,__kZZZ)&&!___UZZZZ){_UZZZ.OZZZZ=true;_UZZZ.__wZZZ.push({_iZZZ:fs,__xZZZ:zZZZZ});_UZZZ.__wZZZ.push({_iZZZ:ts,__xZZZ:this.__WZZ.__WZZ[fs]});}
else if(piece._cZ===_tZZZ&&!___UZZZZ){var __yZZZ=_$ZZZ.__zZZZ(__lZZZ,__nZZZ);var _sZZZ=false;var __AZZZ=false;if(_$ZZZ.__CZZZ(__nZZZ)){_sZZZ=true;if(promote_to!==null&&promote_to>=__DZZZ&&promote_to<=vZZZZ){__AZZZ=true;_UZZZ.__GZZZ=promote_to;}}
if(__AZZZ||!_sZZZ){if(_$ZZZ.__HZZZ(__lZZZ,__nZZZ)){_UZZZ.OZZZZ=true;}
else if(_$ZZZ.__JZZZ(__lZZZ,__nZZZ)){_UZZZ.OZZZZ=true;}
else if(__yZZZ){_UZZZ.OZZZZ=true;}}
if(_UZZZ.OZZZZ){_UZZZ.__wZZZ.push({_iZZZ:ts,__xZZZ:(_sZZZ?_$ZZZ.piece(promote_to,colour):this.__WZZ.__WZZ[fs])});_UZZZ.__wZZZ.push({_iZZZ:fs,__xZZZ:zZZZZ});}}
else if(piece._cZ===GZZZZ&&!___WZZZZ){var ____LZ=new NZZZZ(fs,ts);if(____LZ.OZZZZ){_UZZZ.OZZZZ=true;_UZZZ.__NZZZ=true;_UZZZ.__wZZZ.push({_iZZZ:fs,__xZZZ:zZZZZ});_UZZZ.__wZZZ.push({_iZZZ:ts,__xZZZ:_$ZZZ.piece(GZZZZ,colour)});_UZZZ.__wZZZ.push({_iZZZ:____LZ.VZZZZ,__xZZZ:zZZZZ});_UZZZ.__wZZZ.push({_iZZZ:____LZ.WZZZZ,__xZZZ:_$ZZZ.piece(__LZZZ,colour)});}}
else if(this.___hZZ===_$Z&&(piece._cZ===GZZZZ||piece._cZ===__LZZZ)&&___WZZZZ){_UZZZ.__NZZZ=true;var __OZZZ=[0,7][colour];if(_$ZZZ.__QZ(fs)===__OZZZ&&_$ZZZ.__QZ(ts)===__OZZZ){var __PZZZ=null;var __QZZZ=null;var ___XZZZZ=__OZZZ*8;var ___YZZZZ=___XZZZZ+7;var ___ZZZZZ=_$ZZZ.piece(GZZZZ,colour);for(var wZZZZ=___XZZZZ;wZZZZ<=___YZZZZ;wZZZZ++){if(this.__WZZ.__WZZ[wZZZZ]===___ZZZZZ){__PZZZ=wZZZZ;break;}}
var RZZZZ;if(piece._cZ===__LZZZ){RZZZZ=(_$ZZZ.__PZ(fs)<_$ZZZ.__PZ(ts))?_____g:_____f;}
else if(piece._cZ===GZZZZ){RZZZZ=(_$ZZZ.__PZ(fs)>_$ZZZ.__PZ(ts))?_____g:_____f;}
var __RZZZ=[5,3][RZZZZ];var __SZZZ=[6,2][RZZZZ];var __TZZZ=[7,0][RZZZZ];if(piece._cZ===__LZZZ){__QZZZ=fs;}
else{var __UZZZ=_$ZZZ.__VZZZ(_$ZZZ.__WZZZ([__TZZZ,__OZZZ]),__PZZZ,true);var wZZZZ;for(var O=0;O<__UZZZ.length;O++){wZZZZ=__UZZZ[O];if(this.__WZZ.__WZZ[wZZZZ]===_$ZZZ.piece(__LZZZ,colour)){__QZZZ=wZZZZ;break;}}}
if(__QZZZ!==null){var __XZZZ=_$ZZZ.__WZZZ([__SZZZ,__OZZZ]);var __YZZZ=_$ZZZ.__WZZZ([__RZZZ,__OZZZ]);var __ZZZZ=__PZZZ;var _$ZZZZ=__QZZZ;var _aZZZZ=_$ZZZ.__PZ(__PZZZ);var _bZZZZ=_$ZZZ.__PZ(__QZZZ);if(Math.abs(__TZZZ-__RZZZ)>Math.abs(__TZZZ-_aZZZZ)){__ZZZZ=__YZZZ;}
if(Math.abs(__TZZZ-__SZZZ)<Math.abs(__TZZZ-_bZZZZ)){_$ZZZZ=__XZZZ;}
var _cZZZZ=_$ZZZ.__VZZZ(_$ZZZZ,__ZZZZ,true);var _dZZZZ=0;var _eZZZZ=0;var _fZZZZ=0;var FZZZZ;for(var O=0;O<_cZZZZ.length;O++){wZZZZ=_cZZZZ[O];FZZZZ=this.__WZZ.__WZZ[wZZZZ];if(FZZZZ!==zZZZZ&&_$ZZZ.colour(FZZZZ)===colour){if(_$ZZZ.type(FZZZZ)===__LZZZ){_eZZZZ++;}
else if(_$ZZZ.type(FZZZZ)===GZZZZ){_dZZZZ++;}
else{_fZZZZ++;break;}}}
if(_dZZZZ===1&&_eZZZZ===1&&_fZZZZ===0){_UZZZ.OZZZZ=true;_UZZZ.__wZZZ.push({_iZZZ:__PZZZ,__xZZZ:zZZZZ});_UZZZ.__wZZZ.push({_iZZZ:__QZZZ,__xZZZ:zZZZZ});_UZZZ.__wZZZ.push({_iZZZ:__XZZZ,__xZZZ:_$ZZZ.piece(GZZZZ,colour)});_UZZZ.__wZZZ.push({_iZZZ:__YZZZ,__xZZZ:_$ZZZ.piece(__LZZZ,colour)});}}}}}
return _UZZZ;}
___iZZZZ.prototype.__$ZZZZZ=function(){this.___oZZZZ=false;}
___iZZZZ.prototype.__aZZZZZ=function(){this.___oZZZZ=true;}
___iZZZZ.prototype.__bZZZZZ=function(){var _UZZZ=this._HZZZ.___WZZ.hZZZZZ;if(_UZZZ!==null){if(_UZZZ.__fZZZ!==null){this.__WZZ._____YZZ(_UZZZ.__fZZZ);}
this.__WZZ._____ZZZ(_UZZZ.__gZZZ);}}
___iZZZZ.prototype.___nZZZZ=function(){this.__WZZ.____cZZZ();this.__WZZ.____dZZZ();}
___iZZZZ.prototype.___pZZZZ=function(){if(this._HZZZ._VZZZ===this._HZZZ.___WZZ.hZZZZZ&&this._HZZZ._VZZZ!==null&&this.highlight_last_move){this.__bZZZZZ();}
else{this.___nZZZZ();}}
___iZZZZ.prototype.___TZZ=function(){var mtime_initial=this.___tZZ*u;var _____c=[_____d,kZZZZ];var __RZZZZ;var ____bZ=this.___uZZ*u;var time=[mtime_initial,mtime_initial];var _UZZZ,__cZZZZZ;var clock_start_delay=this.___sZZ*u;var __dZZZZZ=this.___rZZ+1;var last_move_index=this._HZZZ.___WZZ.___XZZ._N-1;if(this.___vZZ!==__N){var _RZZZ=this._XZZZ.__ZZZ;var colour=_$ZZZ._RZZZ(_RZZZ);if(this.___rZZ===-1||last_move_index<0){__RZZZZ=this.___fZZ+clock_start_delay;}
else if(last_move_index>=this.___rZZ){__RZZZZ=this._HZZZ.___WZZ.___XZZ._T(this.___rZZ)._____U+clock_start_delay;}
for(var move_index=__dZZZZZ;move_index<this._HZZZ.___WZZ.___XZZ._N;move_index++){_UZZZ=this._HZZZ.___WZZ.___XZZ._T(move_index);colour=_$ZZZ.______I(move_index);_RZZZ=_$ZZZ._RZZZ(colour);__cZZZZZ=_UZZZ._____U-__RZZZZ;if(_UZZZ===this._HZZZ.___WZZ.hZZZZZ&&(this.___bZZZZ.___gZZZZ!==null&&colour===this.___bZZZZ.___gZZZZ.___VZ)&&this.___kZZZZ&&this.___vZZ!==__J&&this.___vZZ!==__K&&this.___vZZ!==__G){time[colour]=this.___lZZZZ;if(this.___vZZ===__I){time[colour]+=____bZ;}}
else{switch(this.___vZZ){case __H:{time[colour]+=____bZ-Math.max(0,__cZZZZZ);break;}
case __I:{time[colour]+=____bZ-__cZZZZZ;break;}
case __G:{time[colour]+=Math.min(__cZZZZZ,____bZ)-__cZZZZZ;break;}
case __L:{time[colour]-=Math.max(0,__cZZZZZ-____bZ);break;}
case __M:{time[colour]-=__cZZZZZ;break;}
case __J:{time[colour]-=__cZZZZZ;time[_RZZZ]+=__cZZZZZ;break;}
case __K:{time[colour]-=__cZZZZZ;break;}}}
if(this.___wZZ&&_$ZZZ.______M(move_index)===this.___xZZ){time[colour]+=(this.___yZZ*u);}
__RZZZZ=_UZZZ._____U;}
if(last_move_index>this.___rZZ-1){var __eZZZZZ=this.__fZZZZZ();__cZZZZZ=Math.max(0,__eZZZZZ-__RZZZZ);var __gZZZZZ=0;if(this.___vZZ===__L){__gZZZZZ=____bZ;}
time[_RZZZ]-=Math.max(0,__cZZZZZ-__gZZZZZ);if(this.___vZZ===__J){time[colour]+=__cZZZZZ;}
if(this.___vZZ===__H){time[_RZZZ]+=____bZ;}
var colour;for(var _____h=0;_____h<_____c.length;_____h++){colour=_____c[_____h];this._____T._____V(time[colour],colour);if(time[colour]<1){this.__$ZZZZZ();}
if(this.___eZZ===VZ&&time[colour]<=2*u&&!this.__hZZZZZ){this.__iZZZZZ();this.__hZZZZZ=true;}}}}}
___iZZZZ.prototype.__iZZZZZ=function(){if(this.___bZZZZ.___gZZZZ!==null){____v.____X(G("/xhr/check_time.php"),{"gid":this.___eZZZZ});}}
___iZZZZ.prototype.___NZZZZ=function(){this.___TZZ();}
___iZZZZ.prototype.__fZZ=function(){____v.____T(G("/xhr/load_game.php"),function(____x,__jZZZZZ){if(____x!==false){this.__kZZZZZ(____x);this.___p=____x;this.___wZZZZ=false;this.__gZZ();this.__WZZ._oZZZ(this.__YZZ._pZZZ());this.___BZZZZ();this.___MZZZZ();this.___uZZZZ=____x["server_time"];this.___tZZZZ=mtime();this.___vZZZZ=this.___uZZZZ+Math.round(__jZZZZZ/2);this.__lZZZZZ=this.___vZZZZ-this.___tZZZZ;this.__aZZZZZ();this.___TZZ();if(this.___eZZ===VZ){_.m._zZZ(this,function(){if(this.___oZZZZ){this.___TZZ();}});}
if(this.___eZZ===UZ){this._wZZZ(this.___lZZ,this.___mZZ);}
this._EZZZ.t();}},{"gid":this.___eZZZZ},this);}
___iZZZZ.prototype.__kZZZZZ=function(___p){this.___bZZ=___p["owner"];this.___cZZ=___p["white"];this.___dZZ=___p["black"];this._WZZZ=___p["fen"];this.___fZZ=___p["mtime_start"];this._cZ=___p["type"];this.___hZZ=___p["variant"];this.___iZZ=___p["subvariant"];this.___jZZ=___p["bughouse_other_game"];this.___kZZ=___p["format"];this.___nZZ=___p["white_rating_old"];this.___oZZ=___p["white_rating_new"];this.___pZZ=___p["black_rating_old"];this.___qZZ=___p["black_rating_new"];this.___rZZ=___p["clock_start_index"];this.___sZZ=___p["clock_start_delay"];this.___tZZ=___p["timing_initial"];this.___uZZ=___p["timing_increment"];this.___vZZ=___p["timing_style"];this.___wZZ=___p["timing_overtime"];this.___xZZ=___p["timing_overtime_cutoff"];this.___yZZ=___p["timing_overtime_increment"];this.___zZZ=___p["event_type"];this.h=___p["event"];this.___AZZ=___p["round"];this.___GZZ=___p["rated"];this.___UZ=___p["game_id"];if(this._WZZZ!==null||this._WZZZ!==xZZZZZ){this._XZZZ._oZZZ(this._WZZZ);this.__YZZ._oZZZ(this._WZZZ);}
this._____T._____V(this.___tZZ*u,_____d);this._____T._____V(this.___tZZ*u,kZZZZ);this.__hZZ(___p);}
___iZZZZ.prototype.__hZZ=function(___p){this.___eZZ=___p["state"];this.___BZZ=___p["threefold_claimable"];this._sZZZZ=___p["fiftymove_claimable"];this.___DZZ=___p["draw_offered"];this.___FZZ=___p["undo_granted"];if(this.___EZZ&&this.___FZZ){this._HZZZ._zZZZZ();}
this.___EZZ=___p["undo_requested"];this.___lZZ=___p["result"];this.___mZZ=___p["result_details"];this.___gZZ=___p["mtime_finish"];this.___xZZZZ=___p["mtime_last_update"];if(this.___eZZ===UZ){this._wZZZ(this.___lZZ,this.___mZZ);if(this.___mZZ!==__x){this.__$ZZZZZ();}}
this.___m.t();}
___iZZZZ.prototype.__mZZZZZ=function(){____v.____T(G("/xhr/request_undo.php"),function(____x){if(____x===true){this.___EZZ=true;this.___FZZ=false;}},{"gid":this.___eZZZZ},this);}
___iZZZZ.prototype.__nZZZZZ=function(){____v.____T(G("/xhr/grant_undo.php"),function(____x){if(____x===true){this.___EZZ=false;this.___FZZ=true;this._HZZZ._zZZZZ();}},{"gid":this.___eZZZZ},this);}
___iZZZZ.prototype.__gZZ=function(){_.j.____f._zZZ(this,function(__hZZ){__hZZ.____L(this,__R,{"gid":this.___eZZZZ,"mtime_last_update":this.___xZZZZ});});_.j.____g._zZZ(this,function(__hZZ){var data=__hZZ.____N(this);if(data!==null){this.__hZZ(data);}});}
___iZZZZ.prototype._lZZZ=function(fs,ts,promote_to){if(this.__fZZZZZ()<this.___fZZ+(this.___sZZ*u)){this.___KZZZZ(fs,ts,promote_to);}
else{var _sZZZ=false;var piece=this.__YZZ.__WZZ[fs];if(_$ZZZ.type(piece)===_tZZZ&&(_$ZZZ.__QZ(ts)===0||_$ZZZ.__QZ(ts)===7)&&!promote_to){_sZZZ=true;if(_.a.___GZ.___QZ.__OZZ.__wZ()){promote_to=vZZZZ;}
else{this.__WZZ._uZZZ.EZZ();this.__WZZ._uZZZ.___VZ.BZZ(this.___aZZ);this.__WZZ._uZZZ._cZZZ._zZZ(this,function(data){this._lZZZ(fs,ts,data._aZZZ);this.__WZZ._uZZZ.DZZ();return true;});}}
if(promote_to||!_sZZZ){if(this._vZZZ(fs,ts,promote_to).__bZZZ){var _UZZZ=this._HZZZ.___WZZ.hZZZZZ;this.___lZZZZ=this._____T._____U[this.___bZZZZ.___gZZZZ.___VZ];this.___kZZZZ=true;this.__$ZZZZZ();____v.____T("/xhr/move.php",function(____x,__jZZZZZ){if(____x!==false){_UZZZ._____U=____x;this.___mZZZZ=__jZZZZZ;}
else{this._zZZZZ();this.___pZZZZ();}
var self=this;setTimeout(function(){self.__aZZZZZ();},___iZZZZ.___IZZZZ);},{"gid":this.___eZZZZ,"fs":fs,"ts":ts,"promote_to":promote_to,"lrtt":this.___mZZZZ},this);}}}}
___iZZZZ.prototype.___RZZZZ=function(piece,ts){if(this.__oZZZZZ(piece,ts).__bZZZ){var _UZZZ=this._HZZZ.___WZZ.hZZZZZ;this.___lZZZZ=this._____T._____U[this.___bZZZZ.___gZZZZ.___VZ];this.___kZZZZ=true;this.__$ZZZZZ();____v.____T("/xhr/bughouse_move.php",function(____x,__jZZZZZ){if(____x!==false){_UZZZ._____U=____x;this.___mZZZZ=__jZZZZZ;}
else{this._zZZZZ();this.___pZZZZ();}
var self=this;setTimeout(function(){self.__aZZZZZ();},___iZZZZ.___IZZZZ);},{"gid":this.___eZZZZ,"piece":piece,"ts":ts,"lrtt":this.___mZZZZ},this);}}
___iZZZZ.prototype.__oZZZZZ=function(FZZZZ,ts,__dZZZ){__dZZZ=__dZZZ||false;var colour=this.__YZZ.__ZZZ;var piece=new _aZZZ(FZZZZ);var __eZZZ=new _aZZZ(this.__YZZ.__WZZ[ts]);var _UZZZ=new _vZZZ();_UZZZ.__gZZZ=ts;_UZZZ._aZZZ=FZZZZ;if(_$ZZZ.__hZZZ(ts)&&piece._cZ!==zZZZZ&&piece.___VZ===colour&&__eZZZ._cZ===zZZZZ){var _$ZZ=new __YZZ(this.__YZZ._pZZZ());var __kZZZ=_$ZZZ.__jZZZ(ts);var __nZZZ=_$ZZZ.__mZZZ(ts,colour);var _RZZZ=_$ZZZ._RZZZ(colour);_UZZZ.tZZ._aZZZ=_WZZZ.____jZ[FZZZZ];_UZZZ.tZZ.__rZZZ=_____OZ;_UZZZ.tZZ._nZZZ=_$ZZZ.__qZZZ(ts);if(piece._cZ===_tZZZ){var ____zZ=_$ZZZ.__QZ(ts);if(____zZ>0&&____zZ<7){_UZZZ.OZZZZ=true;}}
else if(piece._cZ!==GZZZZ){_UZZZ.OZZZZ=true;}
if(_UZZZ.OZZZZ){_UZZZ.__wZZZ.push({_iZZZ:ts,__xZZZ:FZZZZ});var _jZZZZ;for(var O=0;O<_UZZZ.__wZZZ.length;O++){_jZZZZ=_UZZZ.__wZZZ[O];_$ZZ.DZZZZ(_jZZZZ._iZZZ,_jZZZZ.__xZZZ);}
var _kZZZZ=_$ZZZ._iZZZZ(_$ZZ.__WZZ,_$ZZ.AZZZZ[colour],_RZZZ);if(_kZZZZ.length===0){_UZZZ.__bZZZ=true;}}
if(_UZZZ.__bZZZ){var _lZZZZ=this.__YZZ;this.__YZZ=_$ZZ;if(colour===kZZZZ){this.__YZZ.___PZZ++;}
this.__YZZ.__ZZZ=_RZZZ;if(_UZZZ.__uZZZ!==null||piece._cZ===_tZZZ){this.__YZZ._____T=0;}
else{this.__YZZ._____T++;}
this.__YZZ.__IZZZ=null;if(this.__MZZZ(_RZZZ)){_UZZZ.tZZ._mZZZZ=_nZZZZ;}
if(this._oZZZZ(_RZZZ)){_UZZZ.tZZ._mZZZZ=_pZZZZ;}
if(__dZZZ){this.__YZZ=_lZZZZ;}
else{this.___DZZ=null;this.___EZZ=false;if(this._oZZZZ(_RZZZ)){this._wZZZ(___lZZ._qZZZZ[colour],__q);}
else{if(this.__YZZ._____T>49){this._sZZZZ=true;}
this.___UZZ();}
_UZZZ._WZZZ=this.__YZZ._pZZZ();if(this._HZZZ._vZZZ(_UZZZ)){_UZZZ.R=true;this._JZZZ.t();}
else{this.__YZZ=_lZZZZ;}}}}
return _UZZZ;}
___iZZZZ.prototype._rZZZZ=function(colour){if(this._cZ===XZ){return true;}
else{return __TZZ.prototype._rZZZZ.call(this,colour);}}
___iZZZZ.prototype._oZZZZ=function(colour){if(this._cZ===XZ){var _RZZZ=_$ZZZ._RZZZ(colour);var __pZZZZZ=this.__YZZ.AZZZZ[colour];if(__TZZ.prototype._oZZZZ.call(this,colour)){var _iZZZZ=_$ZZZ._iZZZZ(this.__YZZ.__WZZ,__pZZZZZ,_RZZZ);if(_iZZZZ.length>1){return true;}
else{var wZZZZ=_iZZZZ[0];var type=_$ZZZ.type(this.__YZZ.__WZZ[wZZZZ]);if(type===__DZZZ||type===_tZZZ||_$ZZZ.__VZZZ(wZZZZ,__pZZZZZ).length===0){return true;}}}
return false;}
else{return __TZZ.prototype._oZZZZ.call(this,colour);}}
___iZZZZ.prototype.___YZZ=function(colour){var ___ZZZ=__TZZ.prototype.___YZZ.call(this,colour);if(this._cZ===XZ){for(var type=_tZZZ;type<=vZZZZ;type++){if(this._____UZ[colour]._____XZ[type]>0){for(var wZZZZ=0;wZZZZ<64;wZZZZ++){if(this.__YZZ.__WZZ[wZZZZ]===zZZZZ){if(this.__oZZZZZ(_$ZZZ.piece(type,colour),wZZZZ,true).__bZZZ){___ZZZ++;}}}}}}
return ___ZZZ;}
___iZZZZ.prototype.___JZZZZ=function(){for(var O=0;O<64;O++){this.__WZZ._____VZZ(O);}}
___iZZZZ.prototype.__fZZZZZ=function(){return mtime()+this.__lZZZZZ;}
___iZZZZ.prototype.__jZZ=function(){this.__qZZZZZ();this._HZZZ.__jZZ();this._DZZ();}
___iZZZZ.prototype.__qZZZZZ=function(){this.__WZZ._uZZZ.DZZ();this.___JZZZZ();this.___pZZZZ();this.___yZZZZ.__jZZ();}
___iZZZZ.prototype.__rZZZZZ=function(){____v.____X(G("/xhr/resign.php"),{"gid":this.___eZZZZ});}
___iZZZZ.prototype._wZZZ=function(result,result_details){__TZZ.prototype._wZZZ.call(this,result,result_details);this.__qZZZZZ();this._rZZZ.t();}